<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Simulation Synoptic - Dual Mode</title>
    <link rel="stylesheet" href="../static/css/styles.css">
    <link rel="stylesheet" href="../static/css/svg-synoptic.css">
</head>

<body>
    <div class="container">
        <header class="header-page">
            <h1>Tank Process Simulation - Synoptic Interface</h1>
            <p class="subtitle">Focused on real-time MPC control</p>
        </header>

        <main>
            <!-- Synoptic Board -->
            <section class="synoptic-section">
                <div id="synoptic-board">
                    <!-- SVG will be loaded here -->
                    <div class="placeholder">
                        <p>SVG Synoptic Diagram</p>
                        <small>Load your plant diagram here</small>
                    </div>
                    <!-- Overlays for real-time data display -->
                    <div id="data-overlays"></div>
                </div>
            </section>

            <!-- Control Panel -->
            <aside class="control-panel">
                <div id="realtime-controls">
                    <h2>Real-time Mode</h2>

                    <div class="control-group">
                        <h3>Configuration</h3>
                        <label>
                            Sampling Interval (seconds):
                            <input type="number" id="rt-sampling" value="0.5" min="0.1" max="5" step="0.1">
                        </label>
                        <label>
                            <input type="checkbox" id="rt-enable-noise">
                            Enable Measurement Noise
                        </label>
                    </div>

                    <div class="control-group">
                        <h3>Equilibrium Point</h3>
                        <div class="tank-config">
                            <h4>Levels (m)</h4>
                            <label>Tank A: <input type="number" id="rt-eq-a-level" value="1.5" step="0.1" min="0"
                                    max="3"></label>
                            <label>Tank B: <input type="number" id="rt-eq-b-level" value="1.5" step="0.1" min="0"
                                    max="3"></label>
                            <label>Tank C: <input type="number" id="rt-eq-c-level" value="1.5" step="0.1" min="0"
                                    max="3"></label>
                            <label>Tank D: <input type="number" id="rt-eq-d-level" value="1.5" step="0.1" min="0"
                                    max="3"></label>
                            <label>Tank E: <input type="number" id="rt-eq-e-level" value="1.5" step="0.1" min="0"
                                    max="3"></label>
                        </div>
                        <div class="tank-config">
                            <h4>Concentrations (kg/m続)</h4>
                            <label>Tank C: <input type="number" id="rt-eq-c-conc" value="180" step="10" min="0"
                                    max="360"></label>
                            <label>Tank D: <input type="number" id="rt-eq-d-conc" value="180" step="10" min="0"
                                    max="360"></label>
                            <label>Tank E: <input type="number" id="rt-eq-e-conc" value="180" step="10" min="0"
                                    max="360"></label>
                        </div>
                    </div>

                    <button id="initialize-realtime" class="btn-primary">Initialize</button>
                    <button id="connect-websocket" class="btn-primary" disabled>Connect</button>

                    <div class="control-group" id="rt-runtime-controls" style="display: none;">
                        <h3>Runtime Controls</h3>
                        <button id="rt-pause" class="btn-secondary">Pause</button>
                        <button id="rt-resume" class="btn-secondary" disabled>Resume</button>
                        <button id="rt-reset" class="btn-warning">Reset</button>
                        <button id="rt-disconnect" class="btn-danger">Disconnect</button>
                    </div>

                    <div class="control-group" id="rt-setpoint-controls" style="display: none;">
                        <h3>Change Setpoint</h3>
                        <label>
                            Tank:
                            <select id="rt-sp-tank">
                                <option value="tank_c">Tank C</option>
                                <option value="tank_d">Tank D</option>
                                <option value="tank_e">Tank E</option>
                            </select>
                        </label>
                        <label>
                            Variable:
                            <select id="rt-sp-variable">
                                <option value="level">Level</option>
                                <option value="concentration">Concentration</option>
                            </select>
                        </label>
                        <label>
                            New Value:
                            <input type="number" id="rt-sp-value" step="0.1">
                        </label>
                        <button id="rt-send-setpoint" class="btn-secondary">Set Setpoint</button>
                    </div>

                    <div id="realtime-status" class="status-message"></div>
                </div>
            </aside>
        </main>

        <!-- Data Visualization Panel -->
        <!-- This section must be invisible by default -->
        <section class="data-panel" style="display: none;">
            <h2>Process Data</h2>
            <div id="data-display">
                <h3 class="panel-subtitle">Process Outputs (y)</h3>
                <div class="data-grid">
                    <div class="data-card" id="data-tank-c-level">
                        <h3>Tank C Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-c-conc">
                        <h3>Tank C Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m続</div>
                    </div>
                    <div class="data-card" id="data-tank-d-level">
                        <h3>Tank D Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-d-conc">
                        <h3>Tank D Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m続</div>
                    </div>
                    <div class="data-card" id="data-tank-e-level">
                        <h3>Tank E Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-e-conc">
                        <h3>Tank E Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m続</div>
                    </div>
                </div>

                <h3 class="panel-subtitle">Control Inputs (u)</h3>
                <div class="data-grid control-grid">
                    <div class="data-card control-card" id="data-tank-a-supply">
                        <h3>Tank A Supply Valve</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-b-supply">
                        <h3>Tank B Supply Valve</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-c-water">
                        <h3>Tank C Water Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-c-brine">
                        <h3>Tank C Brine Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-c-outlet">
                        <h3>Tank C Outlet Valve</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-d-water">
                        <h3>Tank D Water Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-d-brine">
                        <h3>Tank D Brine Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-d-outlet">
                        <h3>Tank D Outlet Valve</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-e-water">
                        <h3>Tank E Water Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-e-brine">
                        <h3>Tank E Brine Pump</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                    <div class="data-card control-card" id="data-tank-e-outlet">
                        <h3>Tank E Outlet Valve</h3>
                        <div class="value">--</div>
                        <div class="unit">%</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Real-time Trend Charts -->
        <section class="charts-section">
            <h2>Real-time Trends</h2>

            <div class="chart-row">
                <h3>Tank Levels (A-E)</h3>
                <div class="chart-wrapper">
                    <canvas id="chart-levels"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <h3>Tank Concentrations (C, D, E)</h3>
                <div class="chart-wrapper">
                    <canvas id="chart-concentrations"></canvas>
                </div>
            </div>

            <div class="chart-row">
                <h3>Control Actions</h3>
                <div class="chart-wrapper">
                    <canvas id="chart-controls"></canvas>
                </div>
            </div>
        </section>
    </div>

    <!-- JavaScript Modules -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"
        integrity="sha384-Sse/HDqcypGpyTDpvZOJNnG0TT3feGQUkF9H+mnRvic+LjR+K1NhTt8f51KIQ3v3"
        crossorigin="anonymous"></script>
    <script src="../static/js/charts.js"></script>
    <script src="../static/js/svg-synoptic.js"></script>
    <script src="../static/js/api.js"></script>
    <script src="../static/js/websocket.js"></script>
    <script src="../static/js/ui.js"></script>
    <script src="../static/js/app.js"></script>
</body>

</html>