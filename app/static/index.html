<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tank Simulation Synoptic - Dual Mode</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/svg-synoptic.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Tank Process Simulation - Synoptic Interface</h1>
            <div class="mode-selector">
                <button id="mode-batch" class="mode-btn active" data-mode="batch">
                    <span class="icon">‚è±Ô∏è</span> Batch Simulation
                </button>
                <button id="mode-realtime" class="mode-btn" data-mode="realtime">
                    <span class="icon">‚ö°</span> Real-time Mode
                </button>
            </div>
        </header>

        <main>
            <!-- Synoptic Board -->
            <section class="synoptic-section">
                <div id="synoptic-board">
                    <!-- SVG will be loaded here -->
                    <div class="placeholder">
                        <p>SVG Synoptic Diagram</p>
                        <small>Load your plant diagram here</small>
                    </div>
                    <!-- Overlays for real-time data display -->
                    <div id="data-overlays"></div>
                </div>
            </section>

            <!-- Control Panels -->
            <aside class="control-panel">
                <!-- Batch Mode Controls -->
                <div id="batch-controls" class="mode-controls active">
                    <h2>Batch Simulation</h2>
                    
                    <div class="control-group">
                        <h3>Simulation Configuration</h3>
                        <label>
                            Duration (seconds):
                            <input type="number" id="batch-duration" value="3600" min="0" step="100">
                        </label>
                        <label>
                            Time Step (seconds):
                            <input type="number" id="batch-timestep" value="0.1" min="0.01" max="10" step="0.01">
                        </label>
                        <label>
                            Save Interval (seconds):
                            <input type="number" id="batch-saveinterval" value="1.0" min="0.1" step="0.1">
                        </label>
                        <label>
                            Solver:
                            <select id="batch-solver">
                                <option value="rk4">RK4 (Runge-Kutta 4)</option>
                                <option value="euler">Euler</option>
                                <option value="ode45">ODE45</option>
                            </select>
                        </label>
                    </div>

                    <div class="control-group">
                        <h3>Initial Conditions</h3>
                        <div class="tank-config">
                            <h4>Tank C</h4>
                            <label>Level (m): <input type="number" id="batch-ic-c-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Conc. (kg/m¬≥): <input type="number" id="batch-ic-c-conc" value="180" step="10" min="0" max="360"></label>
                        </div>
                        <div class="tank-config">
                            <h4>Tank D</h4>
                            <label>Level (m): <input type="number" id="batch-ic-d-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Conc. (kg/m¬≥): <input type="number" id="batch-ic-d-conc" value="180" step="10" min="0" max="360"></label>
                        </div>
                        <div class="tank-config">
                            <h4>Tank E</h4>
                            <label>Level (m): <input type="number" id="batch-ic-e-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Conc. (kg/m¬≥): <input type="number" id="batch-ic-e-conc" value="180" step="10" min="0" max="360"></label>
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>Step Inputs (Optional)</h3>
                        <div id="step-inputs-container">
                            <p class="hint">Add step changes in setpoints</p>
                        </div>
                        <button id="add-step-input" class="btn-secondary">‚ûï Add Step Input</button>
                    </div>

                    <button id="run-batch-simulation" class="btn-primary">‚ñ∂Ô∏è Run Simulation</button>
                    <div id="batch-status" class="status-message"></div>
                </div>

                <!-- Real-time Mode Controls -->
                <div id="realtime-controls" class="mode-controls">
                    <h2>Real-time Mode</h2>
                    
                    <div class="control-group">
                        <h3>Configuration</h3>
                        <label>
                            Sampling Interval (seconds):
                            <input type="number" id="rt-sampling" value="0.5" min="0.1" max="5" step="0.1">
                        </label>
                        <label>
                            <input type="checkbox" id="rt-enable-noise">
                            Enable Measurement Noise
                        </label>
                    </div>

                    <div class="control-group">
                        <h3>Equilibrium Point</h3>
                        <div class="tank-config">
                            <h4>Levels (m)</h4>
                            <label>Tank A: <input type="number" id="rt-eq-a-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Tank B: <input type="number" id="rt-eq-b-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Tank C: <input type="number" id="rt-eq-c-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Tank D: <input type="number" id="rt-eq-d-level" value="1.5" step="0.1" min="0" max="3"></label>
                            <label>Tank E: <input type="number" id="rt-eq-e-level" value="1.5" step="0.1" min="0" max="3"></label>
                        </div>
                        <div class="tank-config">
                            <h4>Concentrations (kg/m¬≥)</h4>
                            <label>Tank C: <input type="number" id="rt-eq-c-conc" value="180" step="10" min="0" max="360"></label>
                            <label>Tank D: <input type="number" id="rt-eq-d-conc" value="180" step="10" min="0" max="360"></label>
                            <label>Tank E: <input type="number" id="rt-eq-e-conc" value="180" step="10" min="0" max="360"></label>
                        </div>
                    </div>

                    <button id="initialize-realtime" class="btn-primary">üöÄ Initialize</button>
                    <button id="connect-websocket" class="btn-primary" disabled>üîå Connect</button>
                    
                    <div class="control-group" id="rt-runtime-controls" style="display: none;">
                        <h3>Runtime Controls</h3>
                        <button id="rt-pause" class="btn-secondary">‚è∏Ô∏è Pause</button>
                        <button id="rt-resume" class="btn-secondary" disabled>‚ñ∂Ô∏è Resume</button>
                        <button id="rt-reset" class="btn-warning">üîÑ Reset</button>
                        <button id="rt-disconnect" class="btn-danger">‚õî Disconnect</button>
                    </div>

                    <div class="control-group" id="rt-setpoint-controls" style="display: none;">
                        <h3>Change Setpoint</h3>
                        <label>
                            Tank:
                            <select id="rt-sp-tank">
                                <option value="tank_c">Tank C</option>
                                <option value="tank_d">Tank D</option>
                                <option value="tank_e">Tank E</option>
                            </select>
                        </label>
                        <label>
                            Variable:
                            <select id="rt-sp-variable">
                                <option value="level">Level</option>
                                <option value="concentration">Concentration</option>
                            </select>
                        </label>
                        <label>
                            New Value:
                            <input type="number" id="rt-sp-value" step="0.1">
                        </label>
                        <button id="rt-send-setpoint" class="btn-secondary">üéØ Set Setpoint</button>
                    </div>

                    <div id="realtime-status" class="status-message"></div>
                </div>
            </aside>
        </main>

        <!-- Data Visualization Panel -->
        <section class="data-panel">
            <h2>Process Data</h2>
            <div id="data-display">
                <div class="data-grid">
                    <div class="data-card" id="data-tank-c-level">
                        <h3>Tank C Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-c-conc">
                        <h3>Tank C Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m¬≥</div>
                    </div>
                    <div class="data-card" id="data-tank-d-level">
                        <h3>Tank D Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-d-conc">
                        <h3>Tank D Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m¬≥</div>
                    </div>
                    <div class="data-card" id="data-tank-e-level">
                        <h3>Tank E Level</h3>
                        <div class="value">--</div>
                        <div class="unit">meters</div>
                    </div>
                    <div class="data-card" id="data-tank-e-conc">
                        <h3>Tank E Concentration</h3>
                        <div class="value">--</div>
                        <div class="unit">kg/m¬≥</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- JavaScript Modules -->
    <script src="/static/js/svg-synoptic.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/ui.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>